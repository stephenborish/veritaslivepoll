(function(c){async function f(g,E){if(!g)return"unknown_student";const b=g.toLowerCase().trim(),d=E?`${E}:${b}`:b,r=new TextEncoder().encode(d);try{const a=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(a)).map(s=>s.toString(16).padStart(2,"0")).join("").substring(0,16)}catch(a){console.warn("Web Crypto unavailable, falling back to simple hash",a);for(var e=0,t=0;t<d.length;t++){var n=d.charCodeAt(t);e=(e<<5)-e+n,e=e&e}return"fb_"+Math.abs(e).toString(16)}}c.VeritasShared=c.VeritasShared||{},c.VeritasShared.generateStudentKey=f,c.VeritasDebug={printFirebaseConfig:function(){return console.group("ðŸ”¥ VeritasDebug: Firebase Configuration"),typeof FIREBASE_CONFIG<"u"&&FIREBASE_CONFIG?(console.log("âœ“ FIREBASE_CONFIG exists"),console.log("  databaseURL:",FIREBASE_CONFIG.databaseURL||"(not set)"),console.log("  projectId:",FIREBASE_CONFIG.projectId||"(not set)"),console.log("  Full config:",FIREBASE_CONFIG)):console.warn("âœ— FIREBASE_CONFIG is NOT defined"),typeof firebase<"u"?(console.log("âœ“ firebase SDK is loaded"),console.log("  firebase.apps.length:",firebase.apps?firebase.apps.length:"n/a"),firebase.apps&&firebase.apps.length>0&&(console.log("  Default app name:",firebase.apps[0].name),console.log("  Database URL:",firebase.apps[0].options.databaseURL||"(not set)"))):console.warn("âœ— firebase SDK is NOT loaded"),console.log(typeof firebaseDb<"u"&&firebaseDb?"âœ“ firebaseDb reference exists":"â—‹ firebaseDb reference not in scope (normal before init)"),console.groupEnd(),{configExists:typeof FIREBASE_CONFIG<"u",databaseURL:typeof FIREBASE_CONFIG<"u"&&FIREBASE_CONFIG?FIREBASE_CONFIG.databaseURL:null,firebaseLoaded:typeof firebase<"u",appsLength:typeof firebase<"u"&&firebase.apps?firebase.apps.length:0}},printContext:function(){console.group("ðŸ“‹ VeritasDebug: Page Context"),console.log("Location:",window.location.href),console.log("Page type:",document.title),typeof SESSION_TOKEN<"u"&&console.log("SESSION_TOKEN:",SESSION_TOKEN?"(present, length="+SESSION_TOKEN.length+")":"(empty)"),typeof CURRENT_POLL_DATA<"u"&&console.log("CURRENT_POLL_DATA:",CURRENT_POLL_DATA),console.groupEnd()}}})(window);(function(c){function f(i){var r=Number(i);return isFinite(r)||(r=0),Math.max(0,Math.floor(r))}function g(i){var r=f(i),e=Math.floor(r/60),t=r%60,n=e<10?"0"+e:String(e),a=t<10?"0"+t:String(t);return n+":"+a}function E(i){i=i||{};var r=typeof i.onTick=="function"?i.onTick:function(){},e=typeof i.onExpire=="function"?i.onExpire:function(){},t=null,n=0,a=!1;function u(){t&&(clearInterval(t),t=null),a=!1}function l(){r(n)}function s(){a&&(n=Math.max(0,n-1),l(),n<=0&&(u(),e()))}return{start:function(o){if(n=f(o),u(),n===0){l(),e();return}a=!0,l(),t=setInterval(s,1e3)},pause:function(){a&&u()},stop:function(){u()},add:function(o){var m=f(n+Number(o));n=m,l(),n===0&&a&&(u(),e())},set:function(o){n=f(o),l(),n===0&&a&&(u(),e())},getRemaining:function(){return n},isRunning:function(){return a}}}function b(i){i=i||{};var r=typeof i.onBeat=="function"?i.onBeat:function(){},e=Math.max(500,Number(i.intervalMs)||3e3),t=null;function n(){t=setTimeout(function(){t=null,r(),n()},e)}return{start:function(a){t||(a&&r(),n())},stop:function(){t&&(clearTimeout(t),t=null)},isRunning:function(){return t!==null},pulse:function(){r()},updateInterval:function(a){e=Math.max(500,Number(a)||e),t&&(clearTimeout(t),t=null,n())}}}function d(i,r){var e=i||document;r=r||{};var t=typeof r.onChange=="function"?r.onChange:function(){},n=r.element||e.documentElement;function a(){return!!(e.fullscreenElement||e.webkitFullscreenElement||e.msFullscreenElement)}function u(){if(!n)return Promise.reject(new Error("No element available for fullscreen"));var o=n.requestFullscreen||n.webkitRequestFullscreen||n.msRequestFullscreen;return o?o.call(n):Promise.reject(new Error("Fullscreen API unavailable"))}function l(){var o=e.exitFullscreen||e.webkitExitFullscreen||e.msExitFullscreen;return o?o.call(e):Promise.resolve()}function s(){t({isFullscreen:a(),hidden:e.hidden})}return e.addEventListener("fullscreenchange",s),e.addEventListener("webkitfullscreenchange",s),e.addEventListener("visibilitychange",s),{request:u,exit:l,isFullscreen:a,dispose:function(){e.removeEventListener("fullscreenchange",s),e.removeEventListener("webkitfullscreenchange",s),e.removeEventListener("visibilitychange",s)}}}c.SecureAssessmentShared={formatClock:g,createCountdown:E,createHeartbeat:b,createFullscreenManager:d}})(window);
