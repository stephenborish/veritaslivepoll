[debug] [2026-01-16T14:31:03.706Z] ----------------------------------------------------------------------
[debug] [2026-01-16T14:31:03.708Z] Command:       /usr/local/bin/node /usr/local/bin/firebase functions:shell
[debug] [2026-01-16T14:31:03.708Z] CLI Version:   14.15.2
[debug] [2026-01-16T14:31:03.708Z] Platform:      darwin
[debug] [2026-01-16T14:31:03.708Z] Node Version:  v22.19.0
[debug] [2026-01-16T14:31:03.708Z] Time:          Fri Jan 16 2026 09:31:03 GMT-0500 (Eastern Standard Time)
[debug] [2026-01-16T14:31:03.708Z] ----------------------------------------------------------------------
[debug] 
[debug] [2026-01-16T14:31:03.812Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2026-01-16T14:31:03.812Z] > authorizing via signed-in user (stephenborish@gmail.com)
[debug] [2026-01-16T14:31:03.813Z] [iam] checking project classroomproctor for permissions ["firebase.projects.get"]
[debug] [2026-01-16T14:31:03.813Z] Checked if tokens are valid: true, expires at: 1768576744377
[debug] [2026-01-16T14:31:03.813Z] Checked if tokens are valid: true, expires at: 1768576744377
[debug] [2026-01-16T14:31:03.813Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/classroomproctor:testIamPermissions [none]
[debug] [2026-01-16T14:31:03.813Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/classroomproctor:testIamPermissions x-goog-quota-user=projects/classroomproctor
[debug] [2026-01-16T14:31:03.813Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/classroomproctor:testIamPermissions {"permissions":["firebase.projects.get"]}
[debug] [2026-01-16T14:31:04.047Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/classroomproctor:testIamPermissions 200
[debug] [2026-01-16T14:31:04.047Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/classroomproctor:testIamPermissions {"permissions":["firebase.projects.get"]}
[debug] [2026-01-16T14:31:04.115Z] [functions] Functions Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2026-01-16T14:31:04.161Z] defaultcredentials: writing to file /Users/stephenborish/.config/firebase/stephenborish_gmail_com_application_default_credentials.json
[debug] [2026-01-16T14:31:04.162Z] DEBUG: Setting GAC to /Users/stephenborish/.config/firebase/stephenborish_gmail_com_application_default_credentials.json
[debug] [2026-01-16T14:31:04.162Z] Checked if tokens are valid: true, expires at: 1768576744377
[debug] [2026-01-16T14:31:04.162Z] Checked if tokens are valid: true, expires at: 1768576744377
[debug] [2026-01-16T14:31:04.162Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/classroomproctor/adminSdkConfig [none]
[debug] [2026-01-16T14:31:04.589Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/classroomproctor/adminSdkConfig 200
[debug] [2026-01-16T14:31:04.590Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/classroomproctor/adminSdkConfig {"projectId":"classroomproctor","databaseURL":"https://classroomproctor-default-rtdb.firebaseio.com","storageBucket":"classroomproctor.firebasestorage.app"}
[debug] [2026-01-16T14:31:04.598Z] [functions] Watching "/Users/stephenborish/veritas (01.07.26)/veritaslivepoll/functions" for Cloud Functions...
[debug] [2026-01-16T14:31:04.602Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2026-01-16T14:31:05.139Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "lint": "eslint .",
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "20"
  },
  "main": "index.js",
  "dependencies": {
    "firebase-admin": "^12.6.0",
    "firebase-functions": "^6.0.1",
    "nodemailer": "^7.0.12"
  },
  "devDependencies": {
    "eslint": "^8.15.0",
    "eslint-config-google": "^0.14.0",
    "firebase-functions-test": "^3.1.0"
  },
  "private": true
}
[debug] [2026-01-16T14:31:05.140Z] Building nodejs source
[debug] [2026-01-16T14:31:05.140Z] Failed to find version of module node: reached end of search path /Users/stephenborish/veritas (01.07.26)/veritaslivepoll/functions/node_modules
[warn] ⚠  functions: Your requested "node" version "20" doesn't match your global version "22". Using node@22 from host. 
[info] i  functions: Loaded environment variables from .env. 
[debug] [2026-01-16T14:31:05.141Z] Could not find functions.yaml. Must use http discovery
[debug] [2026-01-16T14:31:05.144Z] Found firebase-functions binary at '/Users/stephenborish/veritas (01.07.26)/veritaslivepoll/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8900

[debug] [2026-01-16T14:31:05.518Z] Got response from /__/functions.yaml {"endpoints":{"setLiveSessionState":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"setLiveSessionState"},"onAnswerSubmitted":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"eventTrigger":{"eventType":"google.firebase.database.ref.v1.written","eventFilters":{},"eventFilterPathPatterns":{"ref":"answers/{pollId}/{studentEmailKey}","instance":"*"},"retry":false},"entryPoint":"onAnswerSubmitted"},"finalizeSession":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"finalizeSession"},"getAnalytics":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"getAnalytics"},"manageProctoring":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"manageProctoring"},"reportStudentViolation":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"reportStudentViolation"},"createPoll":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"createPoll"},"updatePoll":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"updatePoll"},"deletePoll":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"deletePoll"},"manageRoster":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"manageRoster"},"confirmFullscreen":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"confirmFullscreen"},"sendEmail":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"sendEmail"},"manageExams":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"manageExams"},"manageExamSession":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"manageExamSession"},"submitExam":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"submitExam"},"verifyTeacher":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"verifyTeacher"},"createExamSession":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"createExamSession"},"joinSession":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"joinSession"},"sendExamLink":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"sendExamLink"},"submitProctorLog":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"submitProctorLog"},"updateSessionState":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"updateSessionState"},"unlockStudent":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"unlockStudent"},"submitResponse":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"submitResponse"},"gradeResponse":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"eventTrigger":{"eventType":"google.cloud.firestore.document.v1.created","eventFilters":{"database":"(default)","namespace":"(default)"},"eventFilterPathPatterns":{"document":"sessions/{sessionId}/responses/{responseId}"},"retry":false},"entryPoint":"gradeResponse"},"generateSessionReport":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"generateSessionReport"},"getUploadSignedUrl":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"getUploadSignedUrl"},"savePoll":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"savePoll"},"manageQuestionBank":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"manageQuestionBank"},"createClass":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"createClass"},"bulkAddStudents":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"bulkAddStudents"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2026-01-16T14:31:09.554Z] [functions] Loaded functions definitions from source: setLiveSessionState, onAnswerSubmitted, finalizeSession, getAnalytics, manageProctoring, reportStudentViolation, createPoll, updatePoll, deletePoll, manageRoster, confirmFullscreen, sendEmail, manageExams, manageExamSession, submitExam, verifyTeacher, createExamSession, joinSession, sendExamLink, submitProctorLog, updateSessionState, unlockStudent, submitResponse, gradeResponse, generateSessionReport, getUploadSignedUrl, savePoll, manageQuestionBank, createClass, bulkAddStudents.
[debug] [2026-01-16T14:31:09.554Z] [functions[us-central1-setLiveSessionState]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/setLiveSessionState).
[debug] [2026-01-16T14:31:09.554Z] [functions[us-central1-onAnswerSubmitted]] function ignored because the database emulator does not exist or is not running.
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-finalizeSession]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/finalizeSession).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-getAnalytics]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/getAnalytics).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-manageProctoring]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/manageProctoring).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-reportStudentViolation]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/reportStudentViolation).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-createPoll]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/createPoll).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-updatePoll]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/updatePoll).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-deletePoll]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/deletePoll).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-manageRoster]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/manageRoster).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-confirmFullscreen]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/confirmFullscreen).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-sendEmail]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/sendEmail).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-manageExams]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/manageExams).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-manageExamSession]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/manageExamSession).
[debug] [2026-01-16T14:31:09.555Z] [functions[us-central1-submitExam]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/submitExam).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-verifyTeacher]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/verifyTeacher).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-createExamSession]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/createExamSession).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-joinSession]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/joinSession).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-sendExamLink]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/sendExamLink).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-submitProctorLog]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/submitProctorLog).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-updateSessionState]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/updateSessionState).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-unlockStudent]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/unlockStudent).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-submitResponse]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/submitResponse).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-gradeResponse]] function ignored because the firestore emulator does not exist or is not running.
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-generateSessionReport]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/generateSessionReport).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-getUploadSignedUrl]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/getUploadSignedUrl).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-savePoll]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/savePoll).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-manageQuestionBank]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/manageQuestionBank).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-createClass]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/createClass).
[debug] [2026-01-16T14:31:09.556Z] [functions[us-central1-bulkAddStudents]] http function initialized (http://127.0.0.1:5001/classroomproctor/us-central1/bulkAddStudents).
[info] i  functions: Loaded functions: setLiveSessionState, onAnswerSubmitted, finalizeSession, getAnalytics, manageProctoring, reportStudentViolation, createPoll, updatePoll, deletePoll, manageRoster, confirmFullscreen, sendEmail, manageExams, manageExamSession, submitExam, verifyTeacher, createExamSession, joinSession, sendExamLink, submitProctorLog, updateSessionState, unlockStudent, submitResponse, gradeResponse, generateSessionReport, getUploadSignedUrl, savePoll, manageQuestionBank, createClass, bulkAddStudents 
[warn] ⚠  functions: The following emulators are not running, calls to these services will affect production: firestore, database, pubsub, storage, eventarc, tasks 
